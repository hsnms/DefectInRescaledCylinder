#include <math.h>
#include <stdio.h>
#define Pi 3.141592653589793
#define S 0.00000000000001
double Stat (double **u,int n,double *q)
{
	double zero,v1,v2,v4,v5,v6,v7,s,H,h2i,h,K,v8,v9;
	int i,j,k1,k2;
	zero=0.0;h=1.0/(n-1); 
	H=1.0;h2i=1.0/(h*h);
	K=1.0;
	for (i=2;i<=n-1;i++)
	{s=0.0;
		for (j=2;j<=n-1;j++)
		{
			v1=(u[i][j+1]-u[i][j]);
			v2=(u[i][j]-u[i][j-1]);
			v4=(u[i+1][j]-u[i][j]);
			v5=(u[i][j]-u[i-1][j]);
			v6=u[i+1][j+1]-u[i-1][j+1];
			v7=u[i-1][j-1]-u[i+1][j-1];  
			v8=q[j+1]-q[j];
		    v9=q[j]-q[j-1];           
								 
			s=s+2.0*pow(1.0*(i-1)*q[j]/H,2)*(v1-v2)+(2.0*pow(1.0*(i-1),2)+0.5*pow(1.0*(i-1)*(q[j+1]-q[j-1])/H,2)*pow(1.0*(i-1),2))*(v4-v5)+(1.0*(i-1)-pow(1.0*(i-1),3)*q[j]*(q[j+1]+q[j-1]-2.0*q[j])/pow(H,2)+0.5*pow(1.0*(i-1),3)*pow(q[j+1]-q[j-1],2)/pow(H,2))*(v4+v5)-(0.5*pow(1.0*(i-1),3)*q[j]*(q[j+1]-q[j-1])/pow(H,2))*(v6+v7)-sin(2.0*u[i][j]);
/*K*sin(2.0*u[i][j])-(K-1.0)*0.25*sin(2.0*u[i][j])*pow((i-1)*q[j]*(v1+v2),2)+(K-1.0)*(sin(2.0*u[i][j])*pow(1.0*(i-1),2)-sin(2.0*u[i][j])*0.25*pow(1.0*(i-1),4)*pow(v8+v9,2)-cos(2.0*u[i][j])*pow(1.0*(i-1),3)*(v8+v9))*0.25*pow(v4+v5,2)
				+(K-1.0)*(0.5*(v8+v9)*q[j]*sin(2.0*u[i][j])*pow(1.0*(i-1),3)+q[j]*cos(2.0*u[i][j])*pow(1.0*(i-1),2))*0.5*(v4+v5)*(v1+v2)+(-(K*pow(cos(u[i][j]),2)+1.0*pow(sin(u[i][j]),2))*(1.0*(i-1)+pow(1.0*(i-1),3)*(0.5*pow(v8+v9,2)-(v8-v9)*q[j]))-(K-1.0)*pow(1.0*(i-1),2)*0.75*(v8+v9))*(v4+v5)
				+(K-1.0)*sin(2.0*u[i][j])*(i-1)*q[j]*0.5*(v1+v2)-2.0*((K*pow(cos(u[i][j]),2)+1.0*pow(sin(u[i][j]),2))*pow(1.0*(i-1),2)+(K*pow(sin(u[i][j]),2)+1.0*pow(cos(u[i][j]),2))*pow(1.0*(i-1),4)*0.25*pow(v8+v9,2)+(K-1)*pow(1.0*(i-1),3)*0.5*(v8+v9)*sin(2.0*u[i][j]))*(v4-v5)
				-2.0*(K*pow(sin(u[i][j]),2)+1.0*pow(cos(u[i][j]),2))*pow(1.0*(i-1)*q[j],2)*(v1-v2)+((K*pow(sin(u[i][j]),2)+1.0*pow(cos(u[i][j]),2))*pow(1.0*(i-1),3)*(v8+v9)*q[j]+(K-1.0)*q[j]*pow(1.0*(i-1),2)*sin(2.0*u[i][j]))*0.5*(v6+v7);*/
		/*s=s+h2i*(v1-v2+v4-v5)+u[i][j]*u[i][j]-10.0;*/
			
		}
		zero=zero+fabs(s);
	}
	
	

		/*for (i=2;i<=n-1;i++)
	{
			v1=u[i][3]-u[i][2];
		    v2=u[i][2]-u[i][1];
			v4=u[i+1][1]-u[i][1];
			v5=u[i][1]-u[i-1][1];
			v6=u[i+1][3]-u[i-1][3];
			v7=u[i-1][1]-u[i+1][1];         
		zero=zero+2.0*pow(1.0*(i-1)*q[1]/H,2)*(v1-v2)+(2.0*pow(1.0*(i-1),2)+0.5*pow(1.0*(i-1)*(q[3]-q[1])/H,2)*pow(1.0*(i-1),2))*(v4-v5)+(1.0*(i-1)-pow(1.0*(i-1),3)*q[1]*(q[3]+q[1]-2.0*q[2])/pow(H,2)+0.5*pow(1.0*(i-1),3)*pow(q[3]-q[1],2)/pow(H,2))*(v4+v5)-(0.5*pow(1.0*(i-1),3)*q[1]*(q[3]-q[1])/pow(H,2))*(v6+v7)-sin(2.0*u[i][1]);

	}
	for (i=2;i<=n-1;i++)
	{
			v1=u[i][n]-u[i][n-1];
		    v2=u[i][n-1]-u[i][n-2];
			v4=u[i+1][n]-u[i][n];
			v5=u[i][n]-u[i-1][n];
			v6=u[i+1][n]-u[i-1][n];
			v7=u[i-1][n-2]-u[i+1][n-2];           
		zero=zero+2.0*pow(1.0*(i-1)*q[n]/H,2)*(v1-v2)+(2.0*pow(1.0*(i-1),2)+0.5*pow(1.0*(i-1)*(q[n]-q[n-2])/H,2)*pow(1.0*(i-1),2))*(v4-v5)+(1.0*(i-1)-pow(1.0*(i-1),3)*q[n]*(q[n]+q[n-2]-2.0*q[n-1])/pow(H,2)+0.5*pow(1.0*(i-1),3)*pow(q[n]-q[n-2],2)/pow(H,2))*(v4+v5)-(0.5*pow(1.0*(i-1),3)*q[n]*(q[n]-q[n-2])/pow(H,2))*(v6+v7)-sin(2.0*u[i][n]);

	}*/
	/*for (j=2;j<=n-1;j++)
	{
		    v1=u[1][j+1]-u[1][j];
		    v2=u[1][j]-u[1][j-1];
			v4=u[3][j]-u[2][j];
			v5=u[2][j]-u[1][j];
				       

		zero=zero-sin(2.0*u[1][j]);
	}*/
	/*for (j=2;j<=n-1;j++)
	{
		    v1=(u[n][j+1]-u[n][j]);
		    v2=(u[n][j]-u[n][j-1]);
			v4=(u[n][j]-u[n-1][j]);
			v5=(u[n-1][j]-u[n-2][j]);
			v6=u[n][j+1]-u[n-2][j+1];
			v7=u[n-2][j-1]-u[n][j-1];  
zero=zero+2.0*pow(1.0*(n-1)*q[j]/H,2)*(v1-v2)+(2.0*pow(1.0*(n-1),2)+0.5*pow(1.0*(n-1)*(q[j+1]-q[j-1])/H,2)*pow(1.0*(n-1),2))*(v4-v5)+(1.0*(n-1)-pow(1.0*(n-1),3)*q[j]*(q[j+1]+q[j-1]-2.0*q[j])/pow(H,2)+0.5*pow(1.0*(n-1),3)*pow(q[j+1]-q[j-1],2)/pow(H,2))*(v4+v5)-(0.5*pow(1.0*(n-1),3)*q[j]*(q[j+1]-q[j-1])/pow(H,2))*(v6+v7)-sin(2.0*u[n][j]);
						 
	}*/
	/*zero=zero-sin(2.0*u[1][1]);
	zero=zero-sin(2.0*u[1][n]);
	        v1=u[n][3]-u[n][2];
		    v2=u[n][2]-u[n][1];
			v4=u[n][1]-u[n-1][1];
			v5=u[n-1][1]-u[n-2][1];
			v6=u[n][3]-u[n-2][3];
			v7=u[n-2][1]-u[n][1]; 
	zero=zero+2.0*pow(1.0*(n-1)*q[1]/H,2)*(v1-v2)+(2.0*pow(1.0*(n-1),2)+0.5*pow(1.0*(n-1)*(q[3]-q[1])/H,2)*pow(1.0*(n-1),2))*(v4-v5)+(1.0*(n-1)-pow(1.0*(n-1),3)*q[1]*(q[3]+q[1]-2.0*q[2])/pow(H,2)+0.5*pow(1.0*(n-1),3)*pow(q[3]-q[1],2)/pow(H,2))*(v4+v5)-(0.5*pow(1.0*(n-1),3)*q[1]*(q[3]-q[1])/pow(H,2))*(v6+v7)-sin(2.0*u[n][1]);
	        v1=u[n][n]-u[n][n-1];
		    v2=u[n][n-1]-u[n][n-2];
			v4=u[n][n]-u[n-1][n];
			v5=u[n-1][n]-u[n-2][n];
			v6=u[n][n]-u[n-2][n];
			v7=u[n-2][n-2]-u[n][n-2]; 
	zero=zero+2.0*pow(1.0*(n-1)*q[n]/H,2)*(v1-v2)+(2.0*pow(1.0*(n-1),2)+0.5*pow(1.0*(n-1)*(q[n]-q[n-2])/H,2)*pow(1.0*(n-1),2))*(v4-v5)+(1.0*(n-1)-pow(1.0*(n-1),3)*q[n]*(q[n]+q[n-2]-2.0*q[n-1])/pow(H,2)+0.5*pow(1.0*(n-1),3)*pow(q[n]-q[n-2],2)/pow(H,2))*(v4+v5)-(0.5*pow(1.0*(n-1),3)*q[n]*(q[n]-q[n-2])/pow(H,2))*(v6+v7)-sin(2.0*u[n][n]);
	*/zero=zero/((n-2)*(n-2));
	return zero;
}